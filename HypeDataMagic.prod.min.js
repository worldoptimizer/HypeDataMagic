/*
 Hype DataMagic (Core) 1.3.4
copyright (c) 2021 Max Ziebell, (https://maxziebell.de). MIT-license
*/
!1==="HypeDataMagic"in window&&(window.HypeDataMagic=function(){function x(a,b,c){if(c.handler)if("()"==c.handler.slice(-2)){if(a.functions){try{var d=a.functions()[c.handler.slice(0,-2)](a,b,c)}catch(e){console.log('There was an error in your handler "'+c.handler+'": ',e)}return d}}else if("object"==typeof k[c.handler]&&"function"==typeof k[c.handler][c.type]){try{d=k[c.handler][c.type](a,b,c)}catch(e){console.log('There was an error in your handler "'+c.handler+'": ',e)}return d}}function q(a,b,
c){if(b.getAttribute("data-magic-key")){var d=y(b,"data-magic-source")||f.source,e=z(b.getAttribute("data-magic-key")),g="customData"==d?a.customData:A(d);if(g){var h=y(b,"data-magic-branch");g=h?n(g,h):g;g=n(g,e);if(null!=g){if("object"!=typeof g){h=b.getAttribute("data-magic-prefix")||"";var B=b.getAttribute("data-magic-append")||"";if(h||B)g=h+g+B}c=Object.assign({},c,{data:g,source:d,key:e});d=c.type?c.type.replace("HypeScene","DataMagic").split():["DataMagicPrepareForDisplay","DataMagicLoad"];
var H=(b.getAttribute("data-magic-handler")||"text").split(",");d.forEach(function(I){var C;H.forEach(function(J){C=x(a,b,Object.assign({},c,C,{type:I,handler:J.trim()}))})})}else p(a,b)}}}function p(a,b,c){c=Object.assign({},c);handlers=(c.oldHandler||b.getAttribute("data-magic-handler")||"text").split(",");var d;handlers.forEach(function(e){d=x(a,b,Object.assign({},c,d,{type:"DataMagicUnload",handler:e.trim()}))})}function D(a){return!a.querySelectorAll(".HYPE_element, .HYPE_element_container").length}
function K(a,b){l[a.documentId()]||(l[a.documentId()]={changeObserver:new MutationObserver(function(c){c.forEach(function(d){if("attributes"==d.type){var e=d.target,g=d.attributeName,h=z(e.getAttribute(g));d=d.oldValue;if(h!=d)switch(g){case "data-magic-key":h?q(a,e):p(a,e);break;case "data-magic-source":case "data-magic-branch":p(a,e);m(a,e);break;case "data-magic-handler":p(a,e,{oldHandler:d});m(a,e);break;case "data-magic-prefix":case "data-magic-append":m(a,e)}}})}),options:{subtree:!0,attributes:!0,
attributeFilter:"data-magic-key data-magic-source data-magic-branch data-magic-handler data-magic-prefix data-magic-append".split(" "),attributeOldValue:!0},enable:function(){this.changeObserver.observe(b,this.options)},disable:function(){this.changeObserver.disconnect()}})}function r(a){l[a.documentId()]&&l[a.documentId()].enable()}function t(a){l[a.documentId()]&&l[a.documentId()].disable()}function E(a,b,c){b&&b.querySelectorAll("[data-magic-key]").forEach(function(d){q(a,d,c);1==f.forceRedrawElement&&
u(d)})}function F(a,b,c){b&&(q(a,b,c),1==f.forceRedrawElement&&u(b))}function m(a,b,c){b&&(F(a,b,c),E(a,b,c),1==f.forceRedrawDocument&&u(b))}function G(a){a&&a.hasOwnProperty("refresh")?a.refresh():window.hasOwnProperty("HYPE")&&Object.values(window.HYPE.documents).forEach(function(b){b.refresh()})}function A(a,b){if(f.sourceRedirect[a])return v[f.sourceRedirect[a]]||null;a||(a=f.source);var c=v[a]||null;return c&&b?n(c,b):c}function z(a){if("string"==typeof a)return a.trim()}function w(a){if(Array.isArray(a))return a.reduce(function(b,
c){return b.concat(w(c))},[]);if("string"==typeof a)return a=a.replace(/\[(\d+)\]/g,function(b,c){return"."+parseInt(c)}),a=a.replace(/^\./,""),a.split(".")}function n(a,b){if("object"==typeof a){var c=w(b);if(c)return c.reduce(function(d,e){return d&&d.hasOwnProperty(e)?d[e]:null},a)}}function y(a,b){if(!a||!a.id)return null;for(;a.parentNode&&!a.classList.contains("HYPE_scene");){if(a.hasAttribute(b))return a.getAttribute(b);a=a.parentNode}return null}var v={},l={},f={source:"shared",fallbackImage:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="},
handlerMixin:{},sourceRedirect:{},customDataForPreview:{},refreshOnSetData:!0,forceRedrawElement:!0,forceRedrawDocument:!1},u=function(a){var b=a.style.display;a.style.display="none";void 0!=a.offsetHeight;a.style.display=b},k={text:{DataMagicPrepareForDisplay:function(a,b,c){b.innerHTML!=c.data&&D(b)&&(b.innerHTML=c.data)},DataMagicUnload:function(a,b,c){D(b)&&(b.innerHTML="")}},image:{DataMagicPrepareForDisplay:function(a,b,c){"string"==typeof c.data&&(c.data={src:c.data});c.data.src||(c.data.src=
b.dataset.fallbackImage||f.fallbackImage());b.innerHTML="";a.getElementProperty(b,"background-image")!=c.data.src&&(b.style.backgroundRepeat="no-repeat",b.style.backgroundPosition=c.data.backgroundPosition||b.dataset.backgroundPosition||"center center",b.style.backgroundSize=c.data.backgroundSize||b.dataset.backgroundSize||"contain",a.setElementProperty(b,"background-image",c.data.src))},DataMagicUnload:function(a,b,c){a.setElementProperty(b,"background-image","");b.style.backgroundRepeat=b.style.backgroundPosition=
""}}};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,b,c){a.refresh=function(d){m(this,d||document.getElementById(this.currentSceneId()))};a.refreshDescendants=function(d){E(this,d||document.getElementById(this.currentSceneId()))};a.refreshElement=function(d){F(this,d)};a.disableChangeObserver=function(){t(this)};a.enableChangeObserver=function(){r(this)};a.setContentIfNecessary=function(d,e){d.innerHTML!=
e&&(d.innerHTML=e)};K(a,b);r(a)}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,b,c){t(a);m(a,b,c)}});window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(a,b,c){m(a,b,c);r(a)}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(a,b,c){t(a)}});return{version:"1.3.4",setData:function(a,b){b=b||f.source;v[b]=a;1==f.refreshOnSetData&&G()},getData:A,refresh:G,setDefault:function(a,b){f[a]=b},getDefault:function(a){return f[a]},
addDataHandler:function(a,b){if("string"!=!typeof a)switch(typeof b){case "object":k[a]=Object.assign({},f.handlerMixin,b);break;case "function":k[a]=Object.assign({},f.handlerMixin,k.text),k[a].DataMagicPrepareForDisplay=b}},resolveObjectByKey:n,resolveKeyToArray:w}}());
